# Pattern Template: All Paths
# Find multiple alternative routes between nodes
name: all_paths
description: "Find all optimal paths or enumerate alternative routes between nodes"
version: "1.0"

derived_from:
  - patterns/raw/shortest_path_cost_001.yaml

handler: all_shortest_paths
priority: 2  # Lower priority than single shortest_path
success_rate: 0.85

# When this pattern applies
applicability:
  query_signals:
    - "all routes"
    - "all .* routes"
    - "alternative paths"
    - "different ways"
    - "multiple routes"
    - "other options"
    - "backup route"
    - "redundant paths"
    - "enumerate paths"
    - "list all paths"
  relationship_properties:
    is_weighted: true
    traversal_complexity: RED

# Ontology bindings
ontology_bindings:
  node_class: Facility
  edge_relationship: connects_to

# Handler parameters
handler_params:
  nodes_table: facilities
  edges_table: transport_routes
  edge_from_col: origin_facility_id
  edge_to_col: destination_facility_id
  max_depth: 20
  max_paths: 10  # Limit results

# Variants
variants:
  all_optimal:
    description: "Find all paths with equal optimal cost"
    example_queries:
      - "Show all cheapest routes from A to B"
      - "Alternative optimal paths"
    handler_params:
      max_paths: 10
    note: "Returns only paths tied for best weight"

  limited_alternatives:
    description: "Find a few alternative routes"
    example_queries:
      - "Give me 3 route options"
      - "A few different paths"
    handler_params:
      max_paths: 3

# Cautions
cautions:
  - "Can be computationally expensive for dense graphs"
  - "May timeout for graphs with many equivalent paths"
  - "Consider using shortest_path first to verify connectivity"

# Parameter resolution
parameter_mapping:
  nodes_table: "{ontology.tbox.classes.Facility.sql.table}"
  edges_table: "{ontology.rbox.roles.connects_to.sql.table}"
  edge_from_col: "{ontology.rbox.roles.connects_to.sql.domain_key}"
  edge_to_col: "{ontology.rbox.roles.connects_to.sql.range_key}"

# Example instantiation
example:
  query: "What are all the cheapest routes from Chicago to LA?"
  handler: all_shortest_paths
  handler_params:
    nodes_table: facilities
    edges_table: transport_routes
    edge_from_col: origin_facility_id
    edge_to_col: destination_facility_id
    start_id: 1
    end_id: 25
    weight_col: cost_usd
    max_paths: 5
