# Relationship Pattern: provides (Supplier â†’ Part)
# Discovered: Phase 1B - GREEN Relationship Patterns
# Complexity: GREEN

name: provides_relationship_patterns
complexity: GREEN
description: Relationship patterns for provides role (Supplier is primary supplier for Part)

ontology_bindings:
  role: provides
  domain: Supplier
  range: Part
  sql:
    table: parts
    domain_key: primary_supplier_id
    range_key: id

patterns:
  - name: supplier_provides_parts
    description: "Forward traversal: Find all parts a supplier provides"
    applicability:
      keywords: [supplier, provides, parts, supplies, primary]
      intent: "Find all parts where this supplier is the primary supplier"
    parameters:
      - name: supplier_code
        type: string
        required: true
    sql_template: |
      SELECT p.part_number, p.description, p.category,
             p.unit_cost, p.is_critical, p.lead_time_days
      FROM suppliers s
      JOIN parts p ON p.primary_supplier_id = s.id
      WHERE s.supplier_code = {{supplier_code}}
      ORDER BY p.category, p.part_number
    execution:
      time_ms: 6.1

  - name: supplier_part_count
    description: "Count parts by primary supplier"
    applicability:
      keywords: [supplier, parts, count, provides, top]
      intent: "Get count of parts each supplier provides"
    parameters:
      - name: limit
        type: integer
        required: false
        default: 10
    sql_template: |
      SELECT s.supplier_code, s.name, COUNT(p.id) as part_count
      FROM suppliers s
      JOIN parts p ON p.primary_supplier_id = s.id
      GROUP BY s.id, s.supplier_code, s.name
      ORDER BY part_count DESC
      LIMIT {{limit}}
    execution:
      time_ms: 6.1
      result: "SUP00026: 47, SUP00014: 44, SUP00052: 42 parts"

  - name: part_primary_supplier
    description: "Reverse traversal: Find primary supplier for a part"
    applicability:
      keywords: [part, supplier, primary, who supplies, source]
      intent: "Find the primary supplier for a specific part"
    parameters:
      - name: part_number
        type: string
        required: true
    sql_template: |
      SELECT p.part_number, p.description,
             s.supplier_code, s.name as supplier_name, s.tier, s.country
      FROM parts p
      JOIN suppliers s ON p.primary_supplier_id = s.id
      WHERE p.part_number = {{part_number}}
    execution:
      time_ms: 0.8
